<app-header>
  <app-register
    icon
    styleClass="size-12 text-slate-300 dark:text-slate-700"
  ></app-register>
  <app-title title [message]="'app.register.title' | translate"></app-title>
  <app-subtitle
    subtitle
    [message]="'app.register.subtitle' | translate"
  ></app-subtitle>
</app-header>

<app-simple-panel [paddingSize]="'large'">
  <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
    <div>
      <app-labeled-input
        [focus]="false"
        [label]="'app.register.mail' | translate"
        [name]="'email'"
        [id]="'email'"
        [control]="emailControl"
        [type]="'email'"
        [placeholder]="'sheldon@cooper.de'"
        [requiredError]="'app.register.error.mail.required' | translate"
        [invalidError]="'app.register.error.mail.wrong' | translate"
      >
        <ng-template #prefix>
          <app-lettercase
            styleClass="size-6 text-slate-300 dark:text-slate-500"
          ></app-lettercase>
        </ng-template>
      </app-labeled-input>
    </div>

    <div>
      <app-labeled-input
        [label]="'app.register.password' | translate"
        [name]="'password'"
        [id]="'password'"
        [control]="pwdControl"
        [placeholder]="'Passwort eingeben'"
        [type]="isPasswordVisible ? 'text' : 'password'"
        [requiredError]="'app.register.error.password.required' | translate"
        [invalidError]="'app.register.error.password.wrong' | translate"
      >
        <ng-template #prefix>
          <app-lock
            styleClass="size-6 text-slate-300 dark:text-slate-500"
          ></app-lock>
        </ng-template>
        <ng-template #suffix *ngIf="!isPasswordVisible">
          <app-eye-close
            (click)="isPasswordVisible = !isPasswordVisible"
            styleClass="size-6 text-slate-300 dark:text-slate-500 cursor-pointer"
          ></app-eye-close>
        </ng-template>
        <ng-template #suffix *ngIf="isPasswordVisible">
          <app-eye-open
            (click)="isPasswordVisible = !isPasswordVisible"
            styleClass="size-6 text-slate-300 dark:text-slate-500 cursor-pointer"
          ></app-eye-open>
        </ng-template>
      </app-labeled-input>
      <div class="ml-4">
        <ul class="mt-1 list-disc text-sm">
          <li
            [class.text-green-600]="rules.minLength"
            [class.text-slate-500]="!rules.minLength"
          >
            {{
              "app.register.passwordRules.minLength"
                | translate: { pwdLength: MINPWDLENGTH }
            }}
          </li>
          <li
            [class.text-green-600]="rules.hasUpperCase"
            [class.text-slate-500]="!rules.hasUpperCase"
          >
            {{ "app.register.passwordRules.ucChars" | translate }}
          </li>
          <li
            [class.text-green-600]="rules.hasNumber"
            [class.text-slate-500]="!rules.hasNumber"
          >
            {{ "app.register.passwordRules.number" | translate }}
          </li>
          <li
            [class.text-green-600]="rules.hasSpecialChar"
            [class.text-slate-500]="!rules.hasSpecialChar"
          >
            {{ "app.register.passwordRules.specialChars" | translate }}
          </li>
        </ul>
      </div>
    </div>

    <div>
      <button
        [disabled]="!allRulesValid"
        type="submit"
        class="mt-5 flex h-10 w-full cursor-pointer items-center justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm/6 font-semibold text-white shadow-xs hover:bg-indigo-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:cursor-default disabled:bg-gray-200 disabled:text-gray-400"
      >
      <app-circle [ngClass]="{ hidden: !isLoading }" styleClass="h-5 w-5 animate-spin text-indigo-200"></app-circle>
        
        <span [ngClass]="{ hidden: isLoading }">{{
          "app.register.confirmation" | translate
        }}</span>
      </button>

      <app-alert></app-alert>
    </div>
  </form>
</app-simple-panel>

<p class="mt-5 text-center text-sm/6 text-gray-500">
  {{ "app.register.question" | translate }}
  <a href="#" class="font-semibold text-indigo-600 hover:text-indigo-500">
    {{ "app.register.exclamation" | translate }}
  </a>
</p>
